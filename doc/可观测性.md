
                        ┌──────────────────────────────────────────────┐
                        │                Kubernetes Cluster             │
                        │                                               │
                        │   ┌───────────────────────────────────────┐   │
                        │   │           Application Pods            │   │
                        │   │  (stdout / file / structured logs)    │   │
                        │   └───────────────────────────────────────┘   │
                        │                     │                         │
                        │                     ▼                         │
                        │   ┌───────────────────────────────────────┐   │
                        │   │       Vector Agent (DaemonSet)        │   │
                        │   │       - 收集 stdout / file logs       │   │
                        │   │       - 基础预处理/路由                │   │
                        │   │       - 不做重度清洗                   │   │
                        │   └───────────────────────────────────────┘   │
                        │                     │                         │
                        └─────────────────────┼─────────────────────────┘
                                              ▼
                              ┌─────────────────────────────────┐
                              │        Kafka Cluster            │
                              │  （核心缓冲+解耦中间层）          │
                              │                                 │
                              │  topics:                        │
                              │    - run_logs (运行日志)         │
                              │    - biz_logs (经营分析日志)     │
                              │    - metrics(optional)          │
                              └─────────────────────────────────┘
                                              │
                       ┌──────────────────────┴────────────────────────┐
                       │                                               │
                       ▼                                               ▼
       ┌──────────────────────────────────────┐         ┌──────────────────────────────────────┐
       │ Vector Aggregator (StatefulSet)      │         │ Vector Aggregator (StatefulSet)      │
       │   - 消费 biz_logs from Kafka         │         │   - 消费 run_logs from Kafka         │
       │   - Logstash-like 清洗、解析、转换   │         │   - Tagging / 结构化 / 标准化        │
       │   - Schema 校验                      │         │   - 检索优化字段生成                 │
       └──────────────────────────────────────┘         └──────────────────────────────────────┘
                       │                                               │
                       ▼                                               ▼
       ┌──────────────────────────────────────┐         ┌──────────────────────────────────────┐
       │            ClickHouse                │         │             OpenSearch                │
       │   - 经营分析数据仓库                 │         │  - 全文检索、模糊匹配、语义搜索       │
       │   - SQL 报表/OLAP                    │         │  - Dashboards日志 UI                 │
       │   - Prometheus-like metrics storage  │         │  - 高维标签检索（少量）              │
       └──────────────────────────────────────┘         └──────────────────────────────────────┘

                                              ▲
                                              │
                              ┌─────────────────────────────────┐
                              │   OpenTelemetry Collector (OTel)│
                              │     - traces / metrics          │
                              │     - batch + tail sampling     │
                              └─────────────────────────────────┘
                                              │
                                              ▼
                              ┌─────────────────────────────────┐
                              │            Jaeger               │
                              │       (存储在 ClickHouse)       │
                              └─────────────────────────────────┘
                                              │
                                              ▼
                              ┌─────────────────────────────────┐
                              │            Grafana              │
                              │ - 日志 (OpenSearch)             │
                              │ - Trace (Jaeger+CH)             │
                              │ - Metrics (OTel/Prometheus)     │
                              └─────────────────────────────────┘
