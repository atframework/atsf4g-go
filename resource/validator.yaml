# @see 转表工具文档: https://xresloader.atframe.work/
# @see 验证器文档: https://github.com/owent/xresloader?tab=readme-ov-file#%E9%AA%8C%E8%AF%81%E5%99%A8
validator:
  - name: "ExcelItemIdRange_VirtualWritable"
    description: "道具ID范围-可发放虚拟道具"
    rules:
      - 1000-7999

  - name: "ExcelItemIdRange_VirtualReadonly"
    description: "道具ID范围-只读虚拟道具"
    rules:
      - 8000-9999

  - name: "ExcelItemIdRange_RandomPool"
    description: "道具ID范围-随机池/礼包"
    rules:
      - 350000-359999

  - name: "ExcelItemIdRange_Prop"
    description: "道具ID范围-碎片"
    rules:
      - 600000-699999

  - name: "ExcelItemIdRange_Quest"
    description: "道具ID范围-任务"
    rules:
      - 8000000-8999999

  - name: "ExcelItemIdRange_MallProduct"
    description: "道具ID范围-商城商品"
    rules:
      - 9000000-9999999

  - name: "ExcelItemIdRange_ALL"
    description: "可用道具ID范围"
    mode: "or"
    rules:
      - ExcelItemIdRange_VirtualWritable
      - ExcelItemIdRange_VirtualReadonly
      - ExcelItemIdRange_RandomPool
      - ExcelItemIdRange_Prop
      - ExcelItemIdRange_Quest
      - ExcelItemIdRange_MallProduct

  - name: "ExcelItem_ALL_item_id"
    description: "Item.xlsx|道具描述总表|item_id 值校验"
    rules:
      - InTableColumn("Item.xlsx", "道具描述总表", 3, 2, "item_id")
      - InTableColumn("Item.xlsx", "辅助道具(不可获得)", 3, 2, "item_id")

  - name: "ExcelItem_ADDABLE_item_id"
    description: "Item.xlsx|道具描述总表|item_id 值校验"
    mode: "and"
    rules:
      - InTableColumn("Item.xlsx", "道具描述总表", 3, 2, "item_id")
      - Not(InValues(0))
      - Not(ExcelItemIdRange_VirtualReadonly)

  - name: "ExcelRandomPool_random_pool_id_range"
    description: "RandomPool Item.xlsx ID 校验"
    mode: "and"
    rules:
      - ExcelItem_ALL_item_id
      - ExcelItemIdRange_RandomPool

  - name: "ExcelRandomPool_element_type_id"
    description: "ExcelItem_ADDABLE_item_id or 8003 校验"
    mode: "or"
    rules:
      - 8003
      - ExcelItem_ADDABLE_item_id

  - name: "ExcelRandomPool_pool_id"
    description: "RandomPool.xlsx|RandomPool|pool_id 值校验"
    mode: "or"
    rules:
      - InTableColumn("RandomPool.xlsx", "RandomPool", 3, 2, "pool_id")
      - InTableColumn("RandomPool.xlsx", "RandomPoolMerge", 3, 2, "pool_id")

  - name: "ExcelConditionPool_condition_id"
    description: "Condition.xlsx|限制条件|condition_id 值校验"
    rules:
      - InTableColumn("Condition.xlsx", "限制条件", 3, 2, "condition_id")

  - name: "ExcelQuest_id"
    description: "Quest.xlsx|任务|id 值校验"
    rules:
      - InTableColumn("Quest.xlsx", "Quest", 4, 3, "id")

  - name: "ExcelMallSheet_mall_sheet_id"
    description: "Mall.xlsx|商城页签表|mall_sheet_id 值校验"
    rules:
      - InTableColumn("Mall.xlsx", "商城页签表", 3, 2, "mall_sheet_id")

  - name: "ExcelMallProduct_product_id"
    description: "Mall.xlsx|商城商品表|product_id 值校验"
    rules:
      - InTableColumn("Mall.xlsx", "商城商品表", 3, 2, "product_id")